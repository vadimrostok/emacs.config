server {
    listen       8898;
    listen       80;
    server_name  templater.local;

    #charset koi8-r;

    access_log  /Applications/MNPP/logs/nginx/templater.access.log;
    error_log  /Applications/MNPP/logs/nginx/templater.error.log debug;

    #error_page  404              /404.html;

    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   html;
    }

    client_max_body_size 50m;
    client_body_timeout 300s;
    keepalive_timeout 300s;
    lingering_time 300s;
    resolver_timeout 300s;

    expires -24h;

    set $host_path "/Applications/MNPP/htdocs/templater/";

    root   $host_path;
    set $yii_bootstrap "index.php";

    charset utf-8;

    location / {
        index  index.html $yii_bootstrap;
        try_files $uri $uri/ /$yii_bootstrap?$args;
    }

    location ~ ^/(app/test|protected|framework|themes/\w+/views) {
        deny  all;
    }

    location ~ \.php {

        fastcgi_split_path_info  ^(.+\.php)(.*)$;

        #позволяем yii перехватывать запросы к несуществующим PHP-файлам
        set $fsn /$yii_bootstrap;
        if (-f $document_root$fastcgi_script_name){
            set $fsn $fastcgi_script_name;
        }

        fastcgi_connect_timeout 300s;
        fastcgi_read_timeout 300s;
        fastcgi_send_timeout 300s;

        fastcgi_pass   localhost:9000;
        include fastcgi_params;
        fastcgi_param  SCRIPT_FILENAME  $document_root$fsn;

        fastcgi_param  PATH_INFO        $fastcgi_path_info;
        fastcgi_param  PATH_TRANSLATED  $document_root$fsn;

        fastcgi_param  QUERY_STRING    $query_string;
        fastcgi_param  REQUEST_METHOD  $request_method;
        fastcgi_param  CONTENT_TYPE    $content_type;
        fastcgi_param  CONTENT_LENGTH  $content_length;
    }

	#include /Applications/MNPP/conf/nginx/common/php;
}
